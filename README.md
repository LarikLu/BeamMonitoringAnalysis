# Basic Logic Behind the Analysis

Using a steady light source (the light emitted by the scintillator), images were taken at different positions to determine the influence of these locations. The aim is to develop a correction matrix to calibrate the beam monitoring system.

This folder includes both the test images and the analysis program. The program `CorrectionMatrix.C` is particularly relevant, while others are designed for specific functions and can be ignored unless needed.

## Program Overview: `CorrectionMatrix.C`

The program first reads the root files generated by `readtiff`. It then loops over all positions, generating ADC vs. R images with pixel scaling for each position.

### Functions in the Program

1. **GetMaxPosition**  
   This function roughly determines the center of the light spot by identifying the brightest pixel.  
   **Input**: TH2F histogram  
   **Output**: X bin and Y bin of the brightest point.

2. **IntegralRegion**  
   This function integrates the ADC value of a designated rectangular region. It receives the x and y positions of the light spot (obtained from `GetMaxPosition`), then integrates over the region.  
   **Input**: 
   - TH2F histogram 
   - X and Y bins (from `GetMaxPosition`) 
   - Width and height of the rectangular region  
   **Output**: The integral value.

*Note: There is also a program `IntegralR.C` that integrates over R.*

## Results

The results can be viewed in the files `correction_matrix.root` and `integral_distribution.root` (raw data matrix). In the analysis, I integrated almost the entire pixel region. Several positions were found to have extremely high values.

After checking my code, I believe it functions correctly. The ADC vs. R root files for the (-20mm, -30mm) position were included to investigate the large integral observed at this point. The results suggest that while the integral for (i-30, j30) remains relatively constant as R increases, the integral for (i-20, j-30) continues to rise, indicating a positive average ADC value in the original root files.

## Further Investigation

Upon reviewing the original 1D distribution root files for these two positions, I found significant differences in their distribution patterns. While the ADC values for (i-30, j30) remain relatively symmetric around 0, the values for (i-20, j-30) are skewed towards the positive region, leading to the rising trend over R.

## Recommendations for Improvement

1. Consider reviewing the `readtiff` code.
2. Perform the integral over a smaller region where the rising trend stops, and generate a correction matrix based on that region.

With these adjustments, the system should function as expected.
